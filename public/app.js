"use strict";(()=>{var b=document.forms.namedItem("excelForm"),v=document.getElementById("excelFile"),o=document.getElementById("alert"),l=document.getElementById("convert"),d=()=>{o&&(o.style.display="none")},h=e=>{o&&(o.innerHTML=e,o.style.display="block")},i=(e,r)=>{e&&(a?e.setAttribute("aria-busy","true"):e.removeAttribute("aria-busy"),e.textContent=r)};if(!b||!v)throw new Error("Form or file input not found.");d();var a=!1;i(l,"Convert");b.addEventListener("submit",async e=>{e.preventDefault(),d(),a=!0,i(l,"Converting...");let r=new FormData,m=v.files?.[0];if(!m)throw new Error("No file selected for conversion.");r.append("excelFile",m);try{let t=await fetch("/.netlify/functions/convert",{method:"POST",body:r});if(!t.ok){let c="Failed to convert. Server returned:";throw console.error(c,t.status,t.statusText),h(c),new Error(c)}let s=await t.blob(),u=t.headers.get("Content-Disposition"),f=u&&u.match(/filename="(.+?)"/),y=f?f[1]:`em-${new Date().getTime()}.xlsx`,n=document.createElement("a");n.href=URL.createObjectURL(s),n.download=y,document.body.appendChild(n),n.click(),document.body.removeChild(n),d(),a=!1,i(l,"Convert")}catch(t){let s="ERROR:<br>An error occurred during conversion.<br>Please make sure that you are using the official Budget Estimate template and the layout was not changed.";console.error(s,t),h(s),a=!1,i(l,"Convert")}});})();
//# sourceMappingURL=app.js.map
